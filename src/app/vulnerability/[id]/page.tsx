import { Suspense } from "react";
import { VulnerabilityDetailContent } from "@/components/VulnerabilityDetailContent";
import { VulnerabilityDetailShimmer } from "@/components/VulnerabilityDetailShimmer";
import type { VulnerabilityPageProps } from "@/types";

export default async function VulnerabilityPage({
  params,
  searchParams,
}: VulnerabilityPageProps) {
  const paramsData = params.then((p) => ({
    id: decodeURIComponent(p.id),
  }));

  const searchParamsData = searchParams.then((sp) => ({
    ecosystem: sp.ecosystem || "",
    packageName: sp.package || "",
    packageVersion: sp.version || "",
  }));

  return (
    <main className="min-h-screen bg-linear-to-br from-slate-50 via-blue-50/30 to-purple-50/20 dark:from-gray-900 dark:via-blue-950/20 dark:to-purple-950/20 py-8 px-4 sm:px-6 lg:px-8">
      <div className="max-w-5xl mx-auto">
        <Suspense fallback={<VulnerabilityDetailShimmer />}>
          <VulnerabilityDetailContent
            params={paramsData}
            searchParams={searchParamsData}
          />
        </Suspense>
      </div>
    </main>
  );
}
